<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>xyzaia.mail — Quick inbox</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: radial-gradient(circle at top, #ffd9e8 0, #ffeef5 40%, #fff 100%);
      color: #2a2a2a;
    }

    .app {
      width: 100%;
      max-width: 520px;
      background: #fff7fb;
      border-radius: 30px;
      padding: 22px 20px 18px;
      box-shadow:
        0 18px 45px rgba(255, 143, 188, 0.35),
        0 0 0 1px rgba(255, 181, 210, 0.55);
      border: 1px solid #ffe0f0;
    }

    .app-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 16px;
    }

    .logo-pill {
      width: 44px;
      height: 44px;
      border-radius: 16px;
      background: linear-gradient(135deg, #ff7fb0, #ffb0d8);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-weight: 700;
      font-size: 22px;
      flex-shrink: 0;
      box-shadow: 0 8px 20px rgba(255, 143, 188, 0.55);
    }

    .title-wrap {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .title-wrap h1 {
      font-size: 20px;
      font-weight: 700;
      letter-spacing: 0.02em;
    }

    .title-wrap span {
      font-size: 12px;
      color: #87667b;
    }

    .title-wrap .brand {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: #f06292;
      font-weight: 600;
    }

    .label {
      font-size: 12px;
      font-weight: 600;
      color: #a05a86;
      margin-bottom: 6px;
      text-transform: uppercase;
      letter-spacing: 0.09em;
    }

    .input-row {
      margin-bottom: 10px;
    }

    .input-shell {
      position: relative;
      display: flex;
      align-items: center;
      background: #fff;
      border-radius: 999px;
      padding: 4px 10px 4px 16px;
      border: 1px solid #ffd1ea;
      box-shadow: inset 0 0 0 1px rgba(255, 214, 235, 0.7);
    }

    .input-shell span.domain-tag {
      font-size: 11px;
      font-weight: 600;
      color: #f06292;
      padding: 4px 9px;
      border-radius: 999px;
      background: #ffe7f3;
      margin-right: 8px;
      flex-shrink: 0;
    }

    .input-shell input {
      border: none;
      outline: none;
      flex: 1;
      font-size: 14px;
      padding: 6px 2px;
      background: transparent;
      color: #333;
      min-width: 0;
    }

    .input-shell input::placeholder {
      color: #c39ab4;
    }

    .btn-row {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 8px;
      margin-bottom: 14px;
    }

    button {
      border: none;
      border-radius: 999px;
      padding: 8px 10px;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.06s ease, box-shadow 0.06s ease, background 0.12s;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      white-space: nowrap;
    }

    .btn-generate {
      background: #fff;
      color: #d81b60;
      border: 1px solid #ffcfe4;
      box-shadow: 0 0 0 1px rgba(255, 205, 230, 0.7);
    }

    .btn-copy {
      background: #ffe7f3;
      color: #ad1457;
      border: 1px solid #ffc2df;
    }

    .btn-inbox {
      background: linear-gradient(135deg, #ff5e9a, #ff85b8);
      color: #fff;
      box-shadow: 0 9px 18px rgba(255, 115, 170, 0.55);
    }

    button:active {
      transform: translateY(1px) scale(0.99);
      box-shadow: none;
    }

    .btn-inbox:disabled {
      opacity: 0.5;
      cursor: default;
      box-shadow: none;
    }

    .hint {
      font-size: 11px;
      color: #a37590;
      margin-bottom: 12px;
    }

    .divider {
      height: 1px;
      background: linear-gradient(to right, transparent, #ffd4eb, transparent);
      margin-bottom: 10px;
    }

    .list-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 6px;
    }

    .list-header span {
      font-size: 12px;
      color: #a05a86;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.09em;
    }

    .list-header small {
      font-size: 11px;
      color: #b488a2;
    }

    .messages {
      max-height: 320px;
      overflow-y: auto;
      padding-right: 4px;
    }

    .message-empty {
      font-size: 13px;
      color: #b0859c;
      padding: 10px 2px 4px;
    }

    .message-card {
      background: #fff;
      border-radius: 18px;
      padding: 10px 12px 9px;
      margin-bottom: 8px;
      box-shadow:
        0 8px 20px rgba(255, 175, 210, 0.40),
        0 0 0 1px rgba(255, 207, 232, 0.9);
      border: 1px solid #ffd6ea;
    }

    .msg-from {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.09em;
      color: #c05a88;
      margin-bottom: 4px;
      font-weight: 600;
    }

    .msg-subject {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 4px;
      color: #333;
    }

    .msg-snippet {
      font-size: 13px;
      color: #7a5c70;
      line-height: 1.3;
    }

    .msg-meta {
      font-size: 11px;
      color: #b0849b;
      margin-top: 6px;
      display: flex;
      justify-content: space-between;
    }

    .toast {
      position: fixed;
      bottom: 16px;
      left: 50%;
      transform: translateX(-50%) translateY(20px);
      background: #333;
      color: #fff;
      padding: 7px 14px;
      border-radius: 999px;
      font-size: 12px;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.18s ease, transform 0.18s ease;
      z-index: 50;
    }

    .toast.show {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }

    footer {
      margin-top: 6px;
      font-size: 10px;
      text-align: center;
      color: #c08aa4;
    }

    @media (max-width: 480px) {
      .app {
        border-radius: 24px;
        padding: 18px 16px 14px;
      }

      .btn-row {
        grid-template-columns: 1fr 1fr 1fr;
      }
    }
  </style>
</head>
<body>

<div class="app">
  <header class="app-header">
    <div class="logo-pill">X</div>
    <div class="title-wrap">
      <h1>xyzaia.mail</h1>
      <span>Quick inbox for <strong>@xyzaia.store</strong></span>
      <span class="brand">powered by aiaxcart</span>
    </div>
  </header>

  <div class="input-row">
    <div class="label">Email address</div>
    <div class="input-shell">
      <span class="domain-tag">@xyzaia.store</span>
      <input
        id="emailInput"
        type="text"
        placeholder="Type or generate an address"
        autocomplete="off"
      />
    </div>
  </div>

  <div class="btn-row">
    <button class="btn-generate" id="btnGenerate">Generate</button>
    <button class="btn-copy" id="btnCopy">Copy</button>
    <button class="btn-inbox" id="btnInbox">Get inbox</button>
  </div>

  <p class="hint">Any address using <strong>@xyzaia.store</strong> will forward to your Gmail.</p>

  <div class="divider"></div>

  <div class="list-header">
    <span>Messages</span>
    <small id="currentFor">No address selected</small>
  </div>

  <div class="messages" id="messages"></div>

  <footer>xyzaia.store ©2025</footer>
</div>

<div class="toast" id="toast"></div>

<script>
  // === CONFIG: set this to your existing Apps Script URL ===
  const API_URL = "https://script.google.com/macros/s/AKfycbztv0vgot_6It98tpzn5O7HXkzJyb6JM_VSZphikIS1qiynoQWAkGVqbeFF6zs6BAaN8w/exec"; // ?email= will be appended

  const emailInput = document.getElementById("emailInput");
  const btnGenerate = document.getElementById("btnGenerate");
  const btnCopy = document.getElementById("btnCopy");
  const btnInbox = document.getElementById("btnInbox");
  const messagesEl = document.getElementById("messages");
  const currentForEl = document.getElementById("currentFor");
  const toastEl = document.getElementById("toast");

  function showToast(text) {
    toastEl.textContent = text;
    toastEl.classList.add("show");
    setTimeout(() => toastEl.classList.remove("show"), 1500);
  }

  function normalizeEmail(raw) {
    if (!raw) return "";
    raw = raw.trim();

    // Already full address
    if (raw.includes("@")) return raw.toLowerCase();

    // Only left part -> attach domain
    return (raw + "@xyzaia.store").toLowerCase();
  }

  function generateEmail() {
    const prefixes = [
      "user",
      "member",
      "client",
      "account",
      "cart",
      "mail",
      "access",
      "login"
    ];
    const prefix = prefixes[Math.floor(Math.random() * prefixes.length)];
    const num = Math.floor(1000 + Math.random() * 9000); // 4 digits
    const email = `${prefix}${num}@xyzaia.store`;

    emailInput.value = email;
    showToast("Generated.");
    currentForEl.textContent = `Showing latest messages for ${email}`;
  }

  async function copyEmail() {
    const value = normalizeEmail(emailInput.value);
    if (!value) {
      showToast("No email.");
      return;
    }

    try {
      if (navigator.clipboard && navigator.clipboard.writeText) {
        await navigator.clipboard.writeText(value);
      } else {
        // Fallback for older browsers
        const temp = document.createElement("textarea");
        temp.value = value;
        document.body.appendChild(temp);
        temp.select();
        document.execCommand("copy");
        document.body.removeChild(temp);
      }
      showToast("Copied.");
    } catch (e) {
      showToast("No email.");
    }
  }

  function renderMessages(email, items) {
    currentForEl.textContent = `Showing latest ${items.length || 0} messages for ${email}`;

    if (!items || items.length === 0) {
      messagesEl.innerHTML = '<div class="message-empty">No messages yet.</div>';
      return;
    }

    const html = items.map(msg => {
      const from = (msg.from || "Unknown sender");
      const subject = msg.subject || "(No subject)";
      const snippet = msg.snippet || "";
      const date = msg.date || "";
      return `
        <article class="message-card">
          <div class="msg-from">From ${from}</div>
          <div class="msg-subject">${subject}</div>
          <div class="msg-snippet">${snippet}</div>
          <div class="msg-meta">
            <span>${date}</span>
          </div>
        </article>
      `;
    }).join("");

    messagesEl.innerHTML = html;
  }

  async function fetchInbox() {
    let email = normalizeEmail(emailInput.value);

    if (!email) {
      showToast("Enter email.");
      return;
    }

    emailInput.value = email;
    currentForEl.textContent = `Loading messages for ${email}…`;
    messagesEl.innerHTML = "";

    btnInbox.disabled = true;

    try {
      const url = `${API_URL}?email=${encodeURIComponent(email)}`;
      const res = await fetch(url, { method: "GET" });

      if (!res.ok) {
        throw new Error("Request failed");
      }

      const data = await res.json();
      // Expecting data.messages to be an array
      const items = Array.isArray(data.messages) ? data.messages : [];
      renderMessages(email, items);
    } catch (err) {
      console.error(err);
      currentForEl.textContent = `Showing latest messages for ${email}`;
      messagesEl.innerHTML =
        '<div class="message-empty">Unable to load messages right now.</div>';
    } finally {
      btnInbox.disabled = false;
    }
  }

  // === Event bindings ===
  btnGenerate.addEventListener("click", generateEmail);
  btnCopy.addEventListener("click", copyEmail);
  btnInbox.addEventListener("click", fetchInbox);

  // Enter key = Get inbox
  emailInput.addEventListener("keydown", (e) => {
    if (e.key === "Enter") {
      fetchInbox();
    }
  });
</script>

</body>
</html>